<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="clave_electronica_account_move_form_inherit" model="ir.ui.view">
        <field name="name">account.move.inherited</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='partner_id']" position="after">
                <field name="envio_gti" invisible="1"/>
                <field name="tipoVenta" widget="badge"/>
                <field name="plazoVenta" widget="badge"/>
            </xpath>
            <xpath expr="//header" position="inside">
                <button name="enviar_factura" string="Enviar a GTI" class="btn-primary" type="object" invisible="move_type not in ('out_invoice','out_refund') or clave_documento or state != 'posted'" confirm="¿Está seguro de enviar la factura a GTI?"/>
                <button name="action_check_document" string="Consultar Documento" class="btn-primary" type="object" invisible="move_type not in ('out_invoice','out_refund') or gti_document_state or not clave_documento"/>
            </xpath>
            <xpath expr="//field[@name='invoice_line_ids']//list//field[@name='discount']" position="after">
                <field name="discount_code_id" optional="show" required="discount != 0 and parent.move_type in ('out_invoice','out_refund','out_receipt')"/>
            </xpath>
            <xpath expr="//field[@name='partner_shipping_id']" position="before">
                <field
                    name="economic_activity_id"
                    required="move_type != 'entry' "
                    invisible="move_type == 'entry'"
                    domain="[('id', 'in', economic_activities_ids),]"
                    options='{"no_open": True, "no_create": True, "active_test": [("type","in", ("in_invoice", "in_refund"))]}'
                    readonly="state != 'draft'"
                />
                <field
                    name="economic_activities_ids"
                    invisible="1"
                    readonly="1"
                    options='{"active_test": [("type","in", ("in_invoice", "in_refund"))]}'
                />
                <field
                    name="receiver_economic_activity_id"
                    invisible="move_type not in ('out_invoice','out_refund')"
                    domain="[('id', 'in', receiver_economic_activities_ids),]"
                    options='{"no_open": True, "no_create": True}'
                    context="{'active_test': False}"
                    readonly="state != 'draft'"
                />
                <field name="receiver_economic_activities_ids" invisible="1"/>
                <field name="documento_hacienda_id" readonly="1" force_save="1"/>
            </xpath>
            <xpath expr="//page[2]" position="after">
                <page
                    name="fe_invoice_data"
                    string="Facturación Electrónica"
                    invisible="move_type not in ('out_invoice', 'out_refund')">
                    <group name="fe_info_group">
                        <group string="Información FE" name="fe_info">
                            <field name="clave_documento" readonly="1" force_save="1"/>
                            <field name="consecutivo" readonly="1" force_save="1"/>
                        </group>
                        <group string="Documentos electrónicos" name="fe_electronic_docs">
                            <field name="fname_xml_document" invisible="1" readonly="1"/>
                            <field name="xml_document" filename="fname_xml_document" readonly="1" force_save="1"/>
                            <field name="fname_xml_response" invisible="1" readonly="1"/>
                            <field name="xml_response" filename="fname_xml_response" readonly="1" force_save="1"/>
                            <field name="gti_document_state" readonly="1"/>
                            <field name="gti_document_state_description" readonly="1"/>
                        </group>
                    </group>
                </page>
            </xpath>
        </field>
    </record>
</odoo>